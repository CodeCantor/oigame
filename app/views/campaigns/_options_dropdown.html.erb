<%# si el usuario tiene permiso para alguna accion, mostramos el dropdown %>
<% if can? :moderated, campaign or (can? :moderated, campaign && campaign.moderated?) or (can? :deactivate, campaign && campaign.published?) or (can? :participants, campaign && campaign.messages.count > 0) or (can? :update, campaign) or (can? :priority, campaign) or (can? :destroy, campaign) %>
<li class="dropdown">
  <a data-toggle="dropdown" class="dropdown-toggle" href="#">Opciones <b class="caret"></b></a>
    <ul class="dropdown-menu">
      <li>
	<% if can?(:moderated, campaign) %>
	  <a href="mailto:<%= campaign.user.email %>">
	    <i class="icon-envelope"></i>
	    <%= I18n.t(:contact) %>
	  </a>
	<% end %>
      </li>
      <% if campaign.status == 'archived' %>
	<li>
	  <% if can?(:moderated, campaign) %>
	    <%= link_to sub_oigame ? activate_sub_oigame_campaign_path(sub_oigame) : activate_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
	      <i class="icon-ok-circle"></i>
	      <%= t(:activate) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can? :update, campaign %>
	    <%= link_to sub_oigame ? edit_sub_oigame_campaign_path(sub_oigame) : edit_campaign_path(campaign) do %>
	      <i class="icon-pencil"></i>
	      <%= t(:edit) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can? :destroy, campaign %>
	    <%= link_to sub_oigame ? sub_oigame_campaign_path(sub_oigame) : campaign, :confirm => t(:are_you_sure), :method => :delete do %>
	      <i class="icon-trash"></i>
	      <%= t(:delete) %>
	    <% end %>
	  <% end %>
	</li>
      <% elsif campaign.status == 'active' %>
	<li>
	  <% if can?(:archive, campaign) %>
	    <%= link_to sub_oigame ? archive_sub_oigame_campaign_path(sub_oigame) : archive_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
	      <i class="icon-file"></i>
	      <%= t(:archive) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can?(:moderated, campaign) && campaign.moderated? %>
	    <%= link_to sub_oigame ? activate_sub_oigame_campaign_path(sub_oigame) : activate_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
	      <i class="icon-ok-circle"></i>
	      <%= t(:activate) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can?(:deactivate, campaign) && campaign.published? %>
	    <%= link_to sub_oigame ? deactivate_sub_oigame_campaign_path(sub_oigame) : deactivate_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
	      <i class="icon-remove-circle"></i>
	      <%= t(:deactivate) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can? :participants, campaign and campaign.messages.count > 0 %>
	    <%= link_to participants_campaign_path(campaign) do %>
	      <i class="icon-user"></i>
	      <%= t(:download_participants) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can? :update, campaign %>
	    <%= link_to sub_oigame ? edit_sub_oigame_campaign_path(sub_oigame) : edit_campaign_path(campaign) do %>
	      <i class="icon-pencil"></i>
	      <%= t(:edit) %>
	    <% end %>
	  <% end %>
	</li>
	<li>
	  <% if can? :priority, campaign %>
	    <% unless campaign.priority == true %>
	      <%= link_to sub_oigame ? prioritize_sub_oigame_campaign_path(sub_oigame) : prioritize_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
		<i class="icon-star"></i>
		<%= t(:prioritize) %>
	      <% end %>
	    <% else %>
	      <%= link_to sub_oigame ? deprioritize_sub_oigame_campaign_path(sub_oigame) : deprioritize_campaign_path, :confirm => t(:are_you_sure), :method => :post do %>
		<i class="icon-star-empty"></i>
		<%= t(:deprioritize) %>
	      <% end %>
	    <% end %> 
	  <% end %> 
	</li>
	<li>
	  <% if can? :destroy, campaign %>
	    <%= link_to sub_oigame ? sub_oigame_campaign_path(sub_oigame) : campaign, :confirm => t(:are_you_sure), :method => :delete do %>
	      <i class="icon-trash"></i>
	      <%= t(:delete) %>
	    <% end %>
	  <% end %>
	</li>
      <% end %>
    </ul><!-- .dropdown-menu -->
</li><!-- .dropdown -->
<% end %>
